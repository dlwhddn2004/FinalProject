<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="project">
	<typeAlias alias="ProjectVO" type="kr.or.ddit.vo.ProjectVO" />
	<typeAlias alias="JoinVO" type="kr.or.ddit.vo.JoinVO" />
	<typeAlias alias="Project_ProjectParticipantsVO" type="kr.or.ddit.vo.Project_ProjectParticipantsVO" />
	
	<select id="selectProjectList" parameterClass="map" resultClass="java.util.HashMap">
		SELECT *
		FROM PROJECT JOIN PROJECT_PARTICIPANTS on PROJECT.PROJECT_NO = PROJECT_PARTICIPANTS.PROJECT_NO
		WHERE MEM_ID = #mem_id#
		OR PL = #mem_id#
		OR DA = #mem_id#
		OR UA = #mem_id#
		OR TA = #mem_id#
		OR AA = #mem_id#
	</select>
	
	<select id="selectProjectInfo" parameterClass="map" resultClass="ProjectVO">
		SELECT *
		FROM PROJECT
		WHERE PROJECT_NO = #project_no#
	</select>
	
	<select id="selectNotProjectListById" parameterClass="map" resultClass="java.util.HashMap">
		SELECT *
		FROM PROJECT, PROJECT_PARTICIPANTS
		WHERE PROJECT.PROJECT_NO = PROJECT_PARTICIPANTS.PROJECT_NO
		AND PROJECT_ENDSTATUS = 'N'
		AND (MEM_ID = #mem_id#
		OR PL = #mem_id#
		OR DA = #mem_id#
		OR UA = #mem_id#
		OR TA = #mem_id#
		OR AA = #mem_id#)
	</select>
	
	<select id="selectFinishProjectListById" parameterClass="map" resultClass="java.util.HashMap">
		SELECT *
		FROM PROJECT, PROJECT_PARTICIPANTS
		WHERE PROJECT.PROJECT_NO = PROJECT_PARTICIPANTS.PROJECT_NO
		AND PROJECT_ENDSTATUS = 'Y'
		AND (MEM_ID = #mem_id#
		OR PL = #mem_id#
		OR DA = #mem_id#
		OR UA = #mem_id#
		OR TA = #mem_id#
		OR AA = #mem_id#)
	</select>
	
	<select id="selectTodo" parameterClass="map" resultClass="java.util.HashMap">
		SELECT *
		FROM TODO_LIST
		WHERE PROJECT_NO = #project_no#
		AND MEM_ID = #mem_id#
	</select>
	
	<insert id="insertTODO" parameterClass="map">
		<selectKey keyProperty="todo_seq" resultClass="String">
			SELECT
			TODO_SEQ.nextval FROM DUAL
		</selectKey>
		INSERT INTO TODO_LIST (TODO_SEQ,
		                       PROJECT_NO,
		                       MEM_ID,
		                       TODO_TITLE,
		                       TODO_CATEGORY)
		VALUES (#todo_seq#,
		        #project_no#,
		        #mem_id#,
		        #todo_title#,
		        #todo_category#)
	</insert>
	
	<delete id="deleteTodo" parameterClass="map">
		DELETE TODO_LIST WHERE TODO_SEQ = #todo_seq#
	</delete>
</sqlMap>

 


